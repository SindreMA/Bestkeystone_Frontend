import{Q as De}from"./AffixSelector.ed8b6f1b.js";import{_ as ge,L as ye,S as h,s as pe,g as $e,h as n,i as f,p as o,q as _,M as he,N as _e,j as t,t as v,z as M,ae as se,m as x,F as K,C as Z,d as we,u as ke,B as Ce,c as m,K as Ie,o as Se,k as p,n as L,r as F,w as oe,a as Ae,ag as ie,Q as ce,ac as me,v as Te,x as He}from"./index.8ea8b5e1.js";import{a as b,Q as Y}from"./QTr.f875d0ae.js";import{Q as ue}from"./QTable.d1b73e65.js";const Be={props:["ClassItem","ShowAll"],components:{CloudinaryFormat:ye},data(){return{ShowDetails:!1}},methods:{rankAdder(w){return w.forEach(D=>{D.display_score=h.GetPoints(D.score,this.Settings.score_type,this.ClassItem.score,D.runs)}),pe.toArray(h.getListWithRank(w))},isEven(w){return w%2==0}},computed:{Settings(){return this.$store.state.data.settings},Hide(){return!(!this.ShowAll&&this.ClassItem.Rank>5)},TopBack(){return this.ClassItem.ClassSlug=="rouge"||this.ClassItem.ClassSlug=="priest"||this.ClassItem.ClassSlug=="hunter"||this.ClassItem.ClassSlug=="warrior"||this.ClassItem.ClassSlug=="paladin"?!0:this.ClassItem.ClassSlug=="mage"}}},Fe={class:"GreyOverlay"},Me={class:"flex flex-center"},Re={class:"TextCover"},Ge={class:"Score flex"},Pe={class:"flex"},ze={key:0},Ee={class:"Rank flex flex-center"},Qe={class:"flex flex-center"},je={class:"ShowMore"},Ne={key:0,class:"material-icons keyboard_arrow_down icon-grey"};const Ve={key:1,class:"MoreDetails"},Le={class:"flex justify-between"},We={class:"flex"},Ke={key:0};function Ue(w,D,g,k,C,$){const I=$e("CloudinaryFormat");return g.ClassItem.class?(n(),f("div",{key:0,class:"ClassViewWindowMAIN",onMouseover:D[0]||(D[0]=R=>C.ShowDetails=!0),onMouseout:D[1]||(D[1]=R=>C.ShowDetails=!1)},[o(I,{url:`classes/${g.ClassItem.class.name.replace(" ","-")}.jpg`},{default:_(({link:R})=>[$.Hide?(n(),f("div",{key:0,class:he(["ClassViewWindow",{TopBack:$.TopBack}]),style:_e({"background-image":`url(${R})`})},[t("div",Fe,[t("div",Me,[t("div",Re,v(g.ClassItem.class.name),1)]),t("div",Ge,[t("div",Pe,[t("div",null,v(g.ClassItem.display_score),1),$.Settings.score_type=="percent"?(n(),f("div",ze,"%")):M("",!0)]),o(se,null,{default:_(()=>[x(" Runs: "+v(g.ClassItem.runs),1)]),_:1})]),t("div",Ee,[t("div",null,v(g.ClassItem.rank),1)]),t("div",Qe,[t("div",je,[(n(),f("i",Ne,"keyboard_arrow_down"))])])])],6)):M("",!0),C.ShowDetails?(n(),f("div",Ve,[(n(!0),f(K,null,Z($.rankAdder(g.ClassItem.specs),(H,G)=>(n(),f("div",{key:H.score,class:he({Marked:!$.isEven(G)})},[t("div",Le,[t("div",null,v(H.rank),1),t("div",null,v(H.details.name),1),t("div",We,[t("div",null,v(H.display_score),1),$.Settings.score_type=="percent"?(n(),f("div",Ke,"%")):M("",!0)]),o(se,null,{default:_(()=>[x(" Runs: "+v(H.runs),1)]),_:2},1024)])],2))),128))])):M("",!0)]),_:1},8,["url"])],32)):M("",!0)}var de=ge(Be,[["render",Ue]]);const qe={key:0,class:"flex flex-center"},Oe={key:1,class:"HeaderFont nodataInfo"},Je=t("h4",{class:"flex flex-center"},"No data found!",-1),Xe=t("p",{class:"flex flex-center"},"Try to change the settings up in the right",-1),Ye=[Je,Xe],Ze={key:2,class:"HeaderFont"},et={key:0,class:"flex justify-around HeaderFont"},tt=t("div",{class:"Centertext HeaderSize3"},"DPS",-1),st={class:"Centertext HeaderSize2"},at=t("br",null,null,-1),lt=t("div",{class:"flex justify-around Centertext"},[t("div",null,"Rank"),t("div",{style:{"min-width":"150px"}},"Class"),t("div",null,"Score")],-1),rt=t("div",{class:"Centertext HeaderSize3"},"Healer",-1),nt=t("br",null,null,-1),ot=t("div",{class:"flex Centertext justify-around"},[t("div",null,"Rank"),t("div",{style:{"min-width":"150px"}},"Class"),t("div",null,"Score")],-1),it=t("div",{class:"Centertext HeaderSize3"},"Tank",-1),ct=t("br",null,null,-1),ut=t("div",{class:"flex Centertext justify-around"},[t("div",null,"Rank"),t("div",{style:{"min-width":"150px"}},"Class"),t("div",null,"Score")],-1),At=we({__name:"ClassLists",props:{Selected:{},Dungeon:{},dungeon:{}},setup(w){const D=w,g=ke(),k=g.state.data,{Selected:C,Dungeon:$,dungeon:I}=Ce(D),R=i=>g.dispatch("fetchSpecData"),H=i=>{var u=0;return i.toFixed()==i?u=i:i.toFixed()>i?u=i.toFixed():u=(i+.66).toFixed(),parseInt(u)},G=i=>{var u=0;if(i)for(let c=0;c<i.length;c++)u+=i[c].score;return u},U=i=>{var u=0;if(i)for(let c=0;c<i.length;c++)u+=i[c].runs;return u},y=i=>{if(P.value){var u=pe.toArray(h.groupBy(h.groupBy(P.value.data,"role")[i],"class_id")),c=h.groupBy(P.value.data,"role")[i],d=0;if(c)for(let T=0;T<c.length;T++)d+=c[T].score;var z=[];for(let T=0;T<u.length;T++){const E=u[T];var j={class:E[0].class,specs:E,score:G(E),runs:U(E),display_score:0};j.display_score=h.GetPoints(j.score,W.value.score_type,d,j.runs),z.push(j)}return h.getListWithRank(h._sortBy(z,"display_score"))}},W=m(()=>k.settings),Q=m(()=>k.Spec_Data),A=m(()=>k.Specs),te=m(()=>k.Classes),ae=m(()=>k.Spec_Dungeon_Data);m(()=>k.Dungeons_Data);const q=m(()=>k.SelectedPeriode),le=Ie();m(()=>{var i,u;return((u=(i=le.currentRoute)==null?void 0:i.value)==null?void 0:u.path)=="/classes"});const re=m(()=>k.Reloaded_Timestamp),P=m(()=>{var c;if(!Q.value)return[];let i=[...(c=Q.value)==null?void 0:c.data].map(d=>({...d}));if(I.value){var u=h._sortBy([...ae.value].map(d=>({...d})).filter(d=>d.dungeon===I.value&&q.value===d.periode&&d.created>re.value),"created").reverse()[0];if(u)return h.AddClassToSpecs(u.data,[...te.value].map(d=>({...d}))),h.AddSpecDetailsToSpec(u.data,[...A.value].map(d=>({...d}))),u}else if(!I.value&&!u)return Q.value&&Q.value.data&&(h.AddClassToSpecs(i,[...te.value].map(d=>({...d}))),h.AddSpecDetailsToSpec(i,[...A.value].map(d=>({...d})))),{...Q.value,data:i}});return Se(()=>{I.value&&!P.value&&R({id:I.value})}),(i,u)=>(n(),f("div",null,[p(q)&&p(P)&&p(q)!=p(P).periode||!y("DAMAGE")?(n(),f("div",qe,[o(De,{style:{color:"rgb(161, 161, 161)"},size:"500"})])):y("DAMAGE").length===0&&y("TANK").length===0&&y("HEALER").length===0?(n(),f("div",Oe,Ye)):(n(),f("div",Ze,[y("DAMAGE")?(n(),f("div",et,[(n(!0),f(K,null,Z(H(y("DAMAGE").length/6),c=>(n(),f("div",{key:Math.random()+c},[tt,t("div",st,v(c*6-6+1)+"-"+v(c*6),1),at,lt,(n(!0),f(K,null,Z(y("DAMAGE"),d=>(n(),f("div",{key:Math.random()+d.class.id},[d.rank>c*6-6&&d.rank<=c*6?(n(),L(de,{key:0,ClassItem:d,ShowAll:!0},null,8,["ClassItem"])):M("",!0)]))),128))]))),128)),t("div",null,[rt,nt,ot,(n(!0),f(K,null,Z(y("HEALER"),c=>(n(),f("div",{key:Math.random()+c.class.id},[o(de,{ClassItem:c},null,8,["ClassItem"])]))),128))]),t("div",null,[it,ct,ut,(n(!0),f(K,null,Z(y("TANK"),c=>(n(),f("div",{key:Math.random()+c.class.id},[o(de,{ClassItem:c},null,8,["ClassItem"])]))),128))])])):M("",!0)]))]))}});const ee=w=>(Te("data-v-0ebd3ea4"),w=w(),He(),w),dt={id:"Main",class:"HeaderFont"},_t={key:1,class:"HeaderFont"},ft=ee(()=>t("br",null,null,-1)),vt=ee(()=>t("br",null,null,-1)),ht=ee(()=>t("div",{class:"flex justify-center HeaderSize4"},[t("div",null,"There is no data for this request, yet...")],-1)),mt=[ft,vt,ht],gt={class:"flex justify-center"},yt={class:"flex justify-center"},pt={class:"flex justify-center"},wt={key:0},kt=ee(()=>t("i",{class:"material-icons"},"info",-1)),Ct={key:2},St=ee(()=>t("i",{class:"material-icons"},"warning",-1)),bt=we({__name:"ClassTableView",props:{dungeon:{type:Number}},setup(w){const D=w,{dungeon:g}=Ce(D),k=ke(),C=k.state.data,$=m(e=>C.Spec_Data),I=m(()=>C.Specs),R=m(()=>C.Classes),H=k.getters.GetDungeonSpecData;m(()=>C.Dungeons_Data);const G=m(()=>C.SelectedPeriode),U=m(()=>C.settings);let y=F([]),W=F(!1),Q=F(!1),A=F(null),te=F({rowsPerPage:10,page:1,sortBy:"role"}),ae=F({rowsPerPage:12,page:1,sortBy:"ascore",descending:!0}),q=F({rowsPerPage:3,page:1,sortBy:"ascore",descending:!0}),le=F([{name:"role",label:"",field:e=>e.field,align:"left"}]),re=F([{name:"view",label:"",align:"left",field:e=>e},{name:"name",label:"Name",field:e=>e.list[0].class.name,sortable:!0,align:"left"},{name:"runs",label:"Amount of runs",field:e=>e.runs,sortable:!0,align:"center"},{name:"tscore",label:"Total Score",field:e=>e.tscore,sortable:!0,align:"center"},{name:"ascore",label:"Average score",field:e=>e.ascore,sortable:!0,align:"center"},{name:"intime_rate",label:"Success rate",field:e=>{var r;return((r=u(e.id))==null?void 0:r.ontime_percent)||0},sortable:!0,align:"center"}]),P=F([{name:"name",label:"Name",field:e=>`${e.details.name} ${e.class.name}`,sortable:!0,align:"left"},{name:"runs",label:"Amount of runs",field:e=>e.runs,sortable:!0,align:"center"},{name:"tscore",label:"Total Score",field:e=>e.score,sortable:!0,align:"center"},{name:"ascore",label:"Average score",field:e=>z(e.score,"mean",0,e.runs)||0,sortable:!0,align:"center"}]);oe($,()=>{c()}),oe(G,()=>{A.value=null,Q.value=!1,d()}),oe(H,()=>{c()});const i=e=>k.dispatch("fetchSpecData",e),u=e=>{if(y!=null&&y.value)for(let r=0;r<y.value.length;r++){const a=y.value[r];if(a.id==e)return a}return!1},c=()=>{var J;var e=h.groupBy($.value.data,"role");if(g.value){var r=H.filter(V=>V.dungeon===g.value&&G.value===V.periode&&V.created>xe.value.Reloaded_Timestamp);e=h.groupBy((J=h._sortBy(r,"created").reverse()[0])==null?void 0:J.data,"role")}var a=[];for(var s in e)a.push({role:s,list:e[s],expand:!0});for(let V=0;V<a.length;V++){const X=a[V];var l=[],B=h.groupBy(X.list,"class_id");for(var N in B){var S={id:N,list:B[N],tscore:0,ascore:0,pscore:0,runs:0};for(let ne=0;ne<B[N].length;ne++){const ve=B[N][ne];S.tscore+=ve.score,S.runs+=ve.runs}S.truns=j(X.list),S.ascore=z(S.tscore,"mean",T(X.list),S.runs),S.pscore=z(S.tscore,"percent",T(X.list),S.runs),l.push(S)}X.list=l}A.value=a},d=()=>{W.value=!0;var e=C.apiUrl;Ae.get(e+"/Class/ontimerate?periode="+G.value+"&min_level="+U.value.min_keystonelevel+"&amount="+U.value.max_runs+"&limitToLowestDungeon="+U.value.limitbylowestdungeon).then(function(r){y.value=r.data,W.value=!1}).catch(function(r){console.log(r),r.value=!0,W.value=!1})},z=(e,r,a,s)=>h.GetPoints(e,r,a,s),j=e=>{var r=0;for(let a=0;a<e.length;a++)r+=e[a].runs;return r},T=e=>{var r=0;for(let a=0;a<e.length;a++)r+=e[a].score;return r},E=(e,r)=>{for(let a=0;a<A.value.length;a++){const s=A.value[a];if(s.role.toLowerCase()===e.toLowerCase())if(r)for(let l=0;l<s.list.length;l++){const B=s.list[l];if(B.id==r)return B}else return s}},O=e=>{if(R.value)for(let r=0;r<R.value.length;r++){const a=R.value[r];if(a.id==e)return a}},fe=e=>{if(I.value)for(let r=0;r<I.value.length;r++){const a=I.value[r];if(a.id==e)return a}},be=m(()=>{var e=["view","name","runs","tscore","ascore"];return g.value||e.push("intime_rate"),e}),xe=m(()=>C);return Se(()=>{g.value?i({id:g.value}):($.value?c():i(void 0),G.value&&d())}),(e,r)=>(n(),f("div",dt,[p(A)==null?(n(),L(ie,{key:0,class:"absolute-center",style:{color:"rgb(161, 161, 161)"},size:"200"})):p(A).length==0?(n(),f("div",_t,mt)):p(A).length!=0?(n(),L(ue,{key:2,"rows-per-page-options":[],"card-class":"background HeaderFont","table-class":"HeaderFont","table-header-class":"HeaderFont",dark:"",flat:"",rows:p(A),columns:p(le),pagination:p(te),"hide-bottom":"","hide-header":"","row-key":"role"},{body:_(a=>[o(Y,{props:a},{default:_(()=>[o(b,{key:"role",props:a},{default:_(()=>[t("div",gt,[t("div",yt,[o(ye,{url:`roles/${a.row.role.toLowerCase()}.png`},{default:_(({link:s})=>[o(ce,{id:"roleImage","spinner-size":"15px","spinner-color":"white",src:s},null,8,["src"])]),_:2},1032,["url"])]),t("div",pt,[o(me,{dense:"",round:"",flat:"",icon:a.expand?"arrow_drop_down":"arrow_drop_up",onClick:s=>a.expand=!a.expand},null,8,["icon","onClick"])])])]),_:2},1032,["props"])]),_:2},1032,["props"]),a.expand?M("",!0):(n(),L(Y,{key:0,class:"hideHover",props:a},{default:_(()=>[o(b,{colspan:"100%"},{default:_(()=>[o(ue,{"rows-per-page-options":[],"card-class":"background HeaderFont","table-class":"HeaderFont","table-header-class":"HeaderFont",dark:"",flat:"",dense:"","hide-bottom":"",rows:a.row.list,columns:p(re),pagination:p(ae),"row-key":"id","visible-columns":p(be)},{body:_(s=>[o(Y,{props:s},{default:_(()=>[o(b,{key:"view",props:s},{default:_(()=>[o(me,{dense:"",round:"",flat:"",size:"xs",icon:s.expand?"arrow_drop_up":"arrow_drop_down",onClick:l=>s.expand=!s.expand},null,8,["icon","onClick"])]),_:2},1032,["props"]),o(b,{key:"name",props:s},{default:_(()=>[t("div",{style:_e(`color: ${O(s.row.list[0].class_id).color};`)},[o(ce,{"spinner-size":"15px","spinner-color":"white",class:"tableIcon",src:O(s.row.list[0].class_id).icon_url},null,8,["src"]),x(" "+v(`${O(s.row.list[0].class_id).name}`),1)],4)]),_:2},1032,["props"]),o(b,{key:"runs",props:s},{default:_(()=>[x(v(s.row.runs)+" ("+v(Math.round(s.row.runs/s.row.truns*1e4)/100)+"%)",1)]),_:2},1032,["props"]),o(b,{key:"tscore",props:s},{default:_(()=>[x(v(Math.round(s.row.tscore))+" ("+v(s.row.pscore)+"%)",1)]),_:2},1032,["props"]),o(b,{key:"ascore",props:s},{default:_(()=>[x(v(s.row.ascore),1)]),_:2},1032,["props"]),o(b,{key:"intime_rate",props:s},{default:_(()=>[u(s.row.id)?(n(),f("div",wt,[x(v(Math.round(u(s.row.id).ontime_percent*10)/10)+"% ",1),[3,4,8,9].filter(l=>l===s.row.list[0].class_id).length===0?(n(),f(K,{key:0},[o(se,null,{default:_(()=>[x("Success rate is generated separately. This is for all roles. Runs: "+v(u(s.row.id).total_runs),1)]),_:2},1024),kt],64)):M("",!0)])):p(W)?(n(),L(ie,{key:1,size:"15"})):(n(),f("div",Ct,[St,o(se,null,{default:_(()=>[x("Success rate is generated separately. Could not get the data")]),_:1})]))]),_:2},1032,["props"])]),_:2},1032,["props"]),s.expand?(n(),L(Y,{key:0,class:"hideHover",props:s},{default:_(()=>[o(b,{colspan:"100%"},{default:_(()=>[o(ue,{"rows-per-page-options":[],"card-class":"background HeaderFont","table-class":"HeaderFont","table-header-class":"HeaderFont",dark:"",dense:"",flat:"",rows:s.row.list,columns:p(P),pagination:p(q),"hide-bottom":"","row-key":"spec"},{body:_(l=>[o(Y,{props:l},{default:_(()=>[o(b,{key:"name",props:l},{default:_(()=>[t("div",{style:_e(`color: ${O(l.row.class_id).color};`)},[o(ce,{"spinner-size":"15px","spinner-color":"white",class:"tableIcon",src:fe(l.row.spec).icon_url},null,8,["src"]),x(" "+v(`${fe(l.row.spec).name} ${O(l.row.class_id).name}`),1)],4)]),_:2},1032,["props"]),o(b,{key:"runs",props:l},{default:_(()=>[x(v(l.row.runs)+" ("+v(Math.round(l.row.runs/j(E(l.row.role,l.row.class_id).list)*1e4)/100)+"%)",1)]),_:2},1032,["props"]),o(b,{key:"tscore",props:l},{default:_(()=>[x(v(Math.round(l.row.score))+" ("+v(z(l.row.score,"percent",T(E(l.row.role,l.row.class_id).list),l.row.runs))+"%)",1)]),_:2},1032,["props"]),o(b,{key:"ascore",props:l},{default:_(()=>{var B,N,S,J;return[x(v(z((N=(B=l==null?void 0:l.row)==null?void 0:B.score)!=null?N:0,"mean",0,(J=(S=l==null?void 0:l.row)==null?void 0:S.runs)!=null?J:[])),1)]}),_:2},1032,["props"])]),_:2},1032,["props"])]),_:2},1032,["rows","columns","pagination"])]),_:2},1024)]),_:2},1032,["props"])):M("",!0)]),_:2},1032,["rows","columns","pagination","visible-columns"])]),_:2},1024)]),_:2},1032,["props"]))]),_:1},8,["rows","columns","pagination"])):(n(),L(ie,{key:3,class:"absolute-center",style:{color:"rgb(161, 161, 161)"},size:"200"}))]))}});var Tt=ge(bt,[["__scopeId","data-v-0ebd3ea4"]]);export{Tt as C,At as _};
