import{Q as De}from"./AffixSelector.e8ad064c.js";import{_ as ge,L as ye,S as h,s as pe,g as $e,h as n,i as v,p as o,q as _,M as he,N as _e,j as t,t as f,z as M,ae as se,l as b,F as K,C as Z,d as we,u as ke,B as Ce,c as m,K as Ie,o as Se,n as L,r as F,w as oe,a as Ae,m as T,Q as ie,ac as me,ag as ce,v as Te,x as He}from"./index.03169e95.js";import{a as S,Q as Y}from"./QTr.7508ac14.js";import{Q as ue}from"./QTable.aa52e878.js";const Be={props:["ClassItem","ShowAll"],components:{CloudinaryFormat:ye},data(){return{ShowDetails:!1}},methods:{rankAdder(p){return p.forEach(x=>{x.display_score=h.GetPoints(x.score,this.Settings.score_type,this.ClassItem.score,x.runs)}),pe.toArray(h.getListWithRank(p))},isEven(p){return p%2==0}},computed:{Settings(){return this.$store.state.data.settings},Hide(){return!(!this.ShowAll&&this.ClassItem.Rank>5)},TopBack(){return this.ClassItem.ClassSlug=="rouge"||this.ClassItem.ClassSlug=="priest"||this.ClassItem.ClassSlug=="hunter"||this.ClassItem.ClassSlug=="warrior"||this.ClassItem.ClassSlug=="paladin"?!0:this.ClassItem.ClassSlug=="mage"}}},Fe={class:"GreyOverlay"},Me={class:"flex flex-center"},Re={class:"TextCover"},Ge={class:"Score flex"},Pe={class:"flex"},ze={key:0},Ee={class:"Rank flex flex-center"},Qe={class:"flex flex-center"},je={class:"ShowMore"},Ne={key:0,class:"material-icons keyboard_arrow_down icon-grey"};const Ve={key:1,class:"MoreDetails"},Le={class:"flex justify-between"},We={class:"flex"},Ke={key:0};function Ue(p,x,g,w,k,D){const $=$e("CloudinaryFormat");return g.ClassItem.class?(n(),v("div",{key:0,class:"ClassViewWindowMAIN",onMouseover:x[0]||(x[0]=R=>k.ShowDetails=!0),onMouseout:x[1]||(x[1]=R=>k.ShowDetails=!1)},[o($,{url:`classes/${g.ClassItem.class.name.replace(" ","-")}.jpg`},{default:_(({link:R})=>[D.Hide?(n(),v("div",{key:0,class:he(["ClassViewWindow",{TopBack:D.TopBack}]),style:_e({"background-image":`url(${R})`})},[t("div",Fe,[t("div",Me,[t("div",Re,f(g.ClassItem.class.name),1)]),t("div",Ge,[t("div",Pe,[t("div",null,f(g.ClassItem.display_score),1),D.Settings.score_type=="percent"?(n(),v("div",ze,"%")):M("",!0)]),o(se,null,{default:_(()=>[b(" Runs: "+f(g.ClassItem.runs),1)]),_:1})]),t("div",Ee,[t("div",null,f(g.ClassItem.rank),1)]),t("div",Qe,[t("div",je,[(n(),v("i",Ne,"keyboard_arrow_down"))])])])],6)):M("",!0),k.ShowDetails?(n(),v("div",Ve,[(n(!0),v(K,null,Z(D.rankAdder(g.ClassItem.specs),(H,G)=>(n(),v("div",{key:H.score,class:he({Marked:!D.isEven(G)})},[t("div",Le,[t("div",null,f(H.rank),1),t("div",null,f(H.details.name),1),t("div",We,[t("div",null,f(H.display_score),1),D.Settings.score_type=="percent"?(n(),v("div",Ke,"%")):M("",!0)]),o(se,null,{default:_(()=>[b(" Runs: "+f(H.runs),1)]),_:2},1024)])],2))),128))])):M("",!0)]),_:1},8,["url"])],32)):M("",!0)}var de=ge(Be,[["render",Ue]]);const qe={key:0,class:"flex flex-center"},Oe={key:1,class:"HeaderFont nodataInfo"},Je=t("h4",{class:"flex flex-center"},"No data found!",-1),Xe=t("p",{class:"flex flex-center"},"Try to change the settings up in the right",-1),Ye=[Je,Xe],Ze={key:2,class:"HeaderFont"},et={key:0,class:"flex justify-around HeaderFont"},tt=t("div",{class:"Centertext HeaderSize3"},"DPS",-1),st={class:"Centertext HeaderSize2"},at=t("br",null,null,-1),lt=t("div",{class:"flex justify-around Centertext"},[t("div",null,"Rank"),t("div",{style:{"min-width":"150px"}},"Class"),t("div",null,"Score")],-1),rt=t("div",{class:"Centertext HeaderSize3"},"Healer",-1),nt=t("br",null,null,-1),ot=t("div",{class:"flex Centertext justify-around"},[t("div",null,"Rank"),t("div",{style:{"min-width":"150px"}},"Class"),t("div",null,"Score")],-1),it=t("div",{class:"Centertext HeaderSize3"},"Tank",-1),ct=t("br",null,null,-1),ut=t("div",{class:"flex Centertext justify-around"},[t("div",null,"Rank"),t("div",{style:{"min-width":"150px"}},"Class"),t("div",null,"Score")],-1),At=we({__name:"ClassLists",props:{Selected:{},Dungeon:{},dungeon:{}},setup(p){const x=p,g=ke(),w=g.state.data,{Selected:k,Dungeon:D,dungeon:$}=Ce(x),R=i=>g.dispatch("fetchSpecData"),H=i=>{var u=0;return i.toFixed()==i?u=i:i.toFixed()>i?u=i.toFixed():u=(i+.66).toFixed(),parseInt(u)},G=i=>{var u=0;if(i)for(let c=0;c<i.length;c++)u+=i[c].score;return u},U=i=>{var u=0;if(i)for(let c=0;c<i.length;c++)u+=i[c].runs;return u},y=i=>{if(P.value){var u=pe.toArray(h.groupBy(h.groupBy(P.value.data,"role")[i],"class_id")),c=h.groupBy(P.value.data,"role")[i],d=0;if(c)for(let A=0;A<c.length;A++)d+=c[A].score;var z=[];for(let A=0;A<u.length;A++){const E=u[A];var j={class:E[0].class,specs:E,score:G(E),runs:U(E),display_score:0};j.display_score=h.GetPoints(j.score,W.value.score_type,d,j.runs),z.push(j)}return h.getListWithRank(h._sortBy(z,"display_score"))}},W=m(()=>w.settings),Q=m(()=>w.Spec_Data),I=m(()=>w.Specs),te=m(()=>w.Classes),ae=m(()=>w.Spec_Dungeon_Data);m(()=>w.Dungeons_Data);const q=m(()=>w.SelectedPeriode),le=Ie();m(()=>{var i,u;return((u=(i=le.currentRoute)==null?void 0:i.value)==null?void 0:u.path)=="/classes"});const re=m(()=>w.Reloaded_Timestamp),P=m(()=>{var c;if(!Q.value)return[];let i=[...(c=Q.value)==null?void 0:c.data].map(d=>({...d}));if($.value){var u=h._sortBy([...ae.value].map(d=>({...d})).filter(d=>d.dungeon===$.value&&q.value===d.periode&&d.created>re.value),"created").reverse()[0];if(u)return h.AddClassToSpecs(u.data,[...te.value].map(d=>({...d}))),h.AddSpecDetailsToSpec(u.data,[...I.value].map(d=>({...d}))),u}else if(!$.value&&!u)return Q.value&&Q.value.data&&(h.AddClassToSpecs(i,[...te.value].map(d=>({...d}))),h.AddSpecDetailsToSpec(i,[...I.value].map(d=>({...d})))),{...Q.value,data:i}});return Se(()=>{$.value&&!P.value&&R({id:$.value})}),(i,u)=>(n(),v("div",null,[q.value&&P.value&&q.value!=P.value.periode||!y("DAMAGE")?(n(),v("div",qe,[o(De,{style:{color:"rgb(161, 161, 161)"},size:"500"})])):y("DAMAGE").length===0&&y("TANK").length===0&&y("HEALER").length===0?(n(),v("div",Oe,Ye)):(n(),v("div",Ze,[y("DAMAGE")?(n(),v("div",et,[(n(!0),v(K,null,Z(H(y("DAMAGE").length/6),c=>(n(),v("div",{key:Math.random()+c},[tt,t("div",st,f(c*6-6+1)+"-"+f(c*6),1),at,lt,(n(!0),v(K,null,Z(y("DAMAGE"),d=>(n(),v("div",{key:Math.random()+d.class.id},[d.rank>c*6-6&&d.rank<=c*6?(n(),L(de,{key:0,ClassItem:d,ShowAll:!0},null,8,["ClassItem"])):M("",!0)]))),128))]))),128)),t("div",null,[rt,nt,ot,(n(!0),v(K,null,Z(y("HEALER"),c=>(n(),v("div",{key:Math.random()+c.class.id},[o(de,{ClassItem:c},null,8,["ClassItem"])]))),128))]),t("div",null,[it,ct,ut,(n(!0),v(K,null,Z(y("TANK"),c=>(n(),v("div",{key:Math.random()+c.class.id},[o(de,{ClassItem:c},null,8,["ClassItem"])]))),128))])])):M("",!0)]))]))}});const ee=p=>(Te("data-v-0ebd3ea4"),p=p(),He(),p),dt={id:"Main",class:"HeaderFont"},_t={key:1,class:"HeaderFont"},vt=ee(()=>t("br",null,null,-1)),ft=ee(()=>t("br",null,null,-1)),ht=ee(()=>t("div",{class:"flex justify-center HeaderSize4"},[t("div",null,"There is no data for this request, yet...")],-1)),mt=[vt,ft,ht],gt={class:"flex justify-center"},yt={class:"flex justify-center"},pt={class:"flex justify-center"},wt={key:0},kt=ee(()=>t("i",{class:"material-icons"},"info",-1)),Ct={key:2},St=ee(()=>t("i",{class:"material-icons"},"warning",-1)),bt=we({__name:"ClassTableView",props:{dungeon:{type:Number}},setup(p){const x=p,{dungeon:g}=Ce(x),w=ke(),k=w.state.data,D=m(e=>k.Spec_Data),$=m(()=>k.Specs),R=m(()=>k.Classes),H=w.getters.GetDungeonSpecData;m(()=>k.Dungeons_Data);const G=m(()=>k.SelectedPeriode),U=m(()=>k.settings);let y=F([]),W=F(!1),Q=F(!1),I=F(null),te=F({rowsPerPage:10,page:1,sortBy:"role"}),ae=F({rowsPerPage:12,page:1,sortBy:"ascore",descending:!0}),q=F({rowsPerPage:3,page:1,sortBy:"ascore",descending:!0}),le=F([{name:"role",label:"",field:e=>e.field,align:"left"}]),re=F([{name:"view",label:"",align:"left",field:e=>e},{name:"name",label:"Name",field:e=>e.list[0].class.name,sortable:!0,align:"left"},{name:"runs",label:"Amount of runs",field:e=>e.runs,sortable:!0,align:"center"},{name:"tscore",label:"Total Score",field:e=>e.tscore,sortable:!0,align:"center"},{name:"ascore",label:"Average score",field:e=>e.ascore,sortable:!0,align:"center"},{name:"intime_rate",label:"Success rate",field:e=>{var r;return((r=u(e.id))==null?void 0:r.ontime_percent)||0},sortable:!0,align:"center"}]),P=F([{name:"name",label:"Name",field:e=>`${e.details.name} ${e.class.name}`,sortable:!0,align:"left"},{name:"runs",label:"Amount of runs",field:e=>e.runs,sortable:!0,align:"center"},{name:"tscore",label:"Total Score",field:e=>e.score,sortable:!0,align:"center"},{name:"ascore",label:"Average score",field:e=>z(e.score,"mean",0,e.runs)||0,sortable:!0,align:"center"}]);oe(D,()=>{c()}),oe(G,()=>{I.value=null,Q.value=!1,d()}),oe(H,()=>{c()});const i=e=>w.dispatch("fetchSpecData",e),u=e=>{if(y!=null&&y.value)for(let r=0;r<y.value.length;r++){const a=y.value[r];if(a.id==e)return a}return!1},c=()=>{var J;var e=h.groupBy(D.value.data,"role");if(g.value){var r=H.filter(V=>V.dungeon===g.value&&G.value===V.periode&&V.created>xe.value.Reloaded_Timestamp);e=h.groupBy((J=h._sortBy(r,"created").reverse()[0])==null?void 0:J.data,"role")}var a=[];for(var s in e)a.push({role:s,list:e[s],expand:!0});for(let V=0;V<a.length;V++){const X=a[V];var l=[],B=h.groupBy(X.list,"class_id");for(var N in B){var C={id:N,list:B[N],tscore:0,ascore:0,pscore:0,runs:0};for(let ne=0;ne<B[N].length;ne++){const fe=B[N][ne];C.tscore+=fe.score,C.runs+=fe.runs}C.truns=j(X.list),C.ascore=z(C.tscore,"mean",A(X.list),C.runs),C.pscore=z(C.tscore,"percent",A(X.list),C.runs),l.push(C)}X.list=l}I.value=a},d=()=>{W.value=!0;var e=k.apiUrl;Ae.get(e+"/Class/ontimerate?periode="+G.value+"&min_level="+U.value.min_keystonelevel+"&amount="+U.value.max_runs+"&limitToLowestDungeon="+U.value.limitbylowestdungeon).then(function(r){y.value=r.data,W.value=!1}).catch(function(r){console.log(r),r.value=!0,W.value=!1})},z=(e,r,a,s)=>h.GetPoints(e,r,a,s),j=e=>{var r=0;for(let a=0;a<e.length;a++)r+=e[a].runs;return r},A=e=>{var r=0;for(let a=0;a<e.length;a++)r+=e[a].score;return r},E=(e,r)=>{for(let a=0;a<I.value.length;a++){const s=I.value[a];if(s.role.toLowerCase()===e.toLowerCase())if(r)for(let l=0;l<s.list.length;l++){const B=s.list[l];if(B.id==r)return B}else return s}},O=e=>{if(R.value)for(let r=0;r<R.value.length;r++){const a=R.value[r];if(a.id==e)return a}},ve=e=>{if($.value)for(let r=0;r<$.value.length;r++){const a=$.value[r];if(a.id==e)return a}},be=m(()=>{var e=["view","name","runs","tscore","ascore"];return g.value||e.push("intime_rate"),e}),xe=m(()=>k);return Se(()=>{g.value?i({id:g.value}):(D.value?c():i(void 0),G.value&&d())}),(e,r)=>(n(),v("div",dt,[T(I)==null?(n(),L(ce,{key:0,class:"absolute-center",style:{color:"rgb(161, 161, 161)"},size:"200"})):T(I).length==0?(n(),v("div",_t,mt)):T(I).length!=0?(n(),L(ue,{key:2,"rows-per-page-options":[],"card-class":"background HeaderFont","table-class":"HeaderFont","table-header-class":"HeaderFont",dark:"",flat:"",rows:T(I),columns:T(le),pagination:T(te),"hide-bottom":"","hide-header":"","row-key":"role"},{body:_(a=>[o(Y,{props:a},{default:_(()=>[o(S,{key:"role",props:a},{default:_(()=>[t("div",gt,[t("div",yt,[o(ye,{url:`roles/${a.row.role.toLowerCase()}.png`},{default:_(({link:s})=>[o(ie,{id:"roleImage","spinner-size":"15px","spinner-color":"white",src:s},null,8,["src"])]),_:2},1032,["url"])]),t("div",pt,[o(me,{dense:"",round:"",flat:"",icon:a.expand?"arrow_drop_down":"arrow_drop_up",onClick:s=>a.expand=!a.expand},null,8,["icon","onClick"])])])]),_:2},1032,["props"])]),_:2},1032,["props"]),a.expand?M("",!0):(n(),L(Y,{key:0,class:"hideHover",props:a},{default:_(()=>[o(S,{colspan:"100%"},{default:_(()=>[o(ue,{"rows-per-page-options":[],"card-class":"background HeaderFont","table-class":"HeaderFont","table-header-class":"HeaderFont",dark:"",flat:"",dense:"","hide-bottom":"",rows:a.row.list,columns:T(re),pagination:T(ae),"row-key":"id","visible-columns":be.value},{body:_(s=>[o(Y,{props:s},{default:_(()=>[o(S,{key:"view",props:s},{default:_(()=>[o(me,{dense:"",round:"",flat:"",size:"xs",icon:s.expand?"arrow_drop_up":"arrow_drop_down",onClick:l=>s.expand=!s.expand},null,8,["icon","onClick"])]),_:2},1032,["props"]),o(S,{key:"name",props:s},{default:_(()=>[t("div",{style:_e(`color: ${O(s.row.list[0].class_id).color};`)},[o(ie,{"spinner-size":"15px","spinner-color":"white",class:"tableIcon",src:O(s.row.list[0].class_id).icon_url},null,8,["src"]),b(" "+f(`${O(s.row.list[0].class_id).name}`),1)],4)]),_:2},1032,["props"]),o(S,{key:"runs",props:s},{default:_(()=>[b(f(s.row.runs)+" ("+f(Math.round(s.row.runs/s.row.truns*1e4)/100)+"%)",1)]),_:2},1032,["props"]),o(S,{key:"tscore",props:s},{default:_(()=>[b(f(Math.round(s.row.tscore))+" ("+f(s.row.pscore)+"%)",1)]),_:2},1032,["props"]),o(S,{key:"ascore",props:s},{default:_(()=>[b(f(s.row.ascore),1)]),_:2},1032,["props"]),o(S,{key:"intime_rate",props:s},{default:_(()=>[u(s.row.id)?(n(),v("div",wt,[b(f(Math.round(u(s.row.id).ontime_percent*10)/10)+"% ",1),[3,4,8,9].filter(l=>l===s.row.list[0].class_id).length===0?(n(),v(K,{key:0},[o(se,null,{default:_(()=>[b("Success rate is generated separately. This is for all roles. Runs: "+f(u(s.row.id).total_runs),1)]),_:2},1024),kt],64)):M("",!0)])):T(W)?(n(),L(ce,{key:1,size:"15"})):(n(),v("div",Ct,[St,o(se,null,{default:_(()=>[b("Success rate is generated separately. Could not get the data")]),_:1})]))]),_:2},1032,["props"])]),_:2},1032,["props"]),s.expand?(n(),L(Y,{key:0,class:"hideHover",props:s},{default:_(()=>[o(S,{colspan:"100%"},{default:_(()=>[o(ue,{"rows-per-page-options":[],"card-class":"background HeaderFont","table-class":"HeaderFont","table-header-class":"HeaderFont",dark:"",dense:"",flat:"",rows:s.row.list,columns:T(P),pagination:T(q),"hide-bottom":"","row-key":"spec"},{body:_(l=>[o(Y,{props:l},{default:_(()=>[o(S,{key:"name",props:l},{default:_(()=>[t("div",{style:_e(`color: ${O(l.row.class_id).color};`)},[o(ie,{"spinner-size":"15px","spinner-color":"white",class:"tableIcon",src:ve(l.row.spec).icon_url},null,8,["src"]),b(" "+f(`${ve(l.row.spec).name} ${O(l.row.class_id).name}`),1)],4)]),_:2},1032,["props"]),o(S,{key:"runs",props:l},{default:_(()=>[b(f(l.row.runs)+" ("+f(Math.round(l.row.runs/j(E(l.row.role,l.row.class_id).list)*1e4)/100)+"%)",1)]),_:2},1032,["props"]),o(S,{key:"tscore",props:l},{default:_(()=>[b(f(Math.round(l.row.score))+" ("+f(z(l.row.score,"percent",A(E(l.row.role,l.row.class_id).list),l.row.runs))+"%)",1)]),_:2},1032,["props"]),o(S,{key:"ascore",props:l},{default:_(()=>{var B,N,C,J;return[b(f(z((N=(B=l==null?void 0:l.row)==null?void 0:B.score)!=null?N:0,"mean",0,(J=(C=l==null?void 0:l.row)==null?void 0:C.runs)!=null?J:[])),1)]}),_:2},1032,["props"])]),_:2},1032,["props"])]),_:2},1032,["rows","columns","pagination"])]),_:2},1024)]),_:2},1032,["props"])):M("",!0)]),_:2},1032,["rows","columns","pagination","visible-columns"])]),_:2},1024)]),_:2},1032,["props"]))]),_:1},8,["rows","columns","pagination"])):(n(),L(ce,{key:3,class:"absolute-center",style:{color:"rgb(161, 161, 161)"},size:"200"}))]))}});var Tt=ge(bt,[["__scopeId","data-v-0ebd3ea4"]]);export{Tt as C,At as _};
